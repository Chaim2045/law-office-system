<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ” Admin Panel Diagnostics</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .content {
            padding: 30px;
        }

        .test-section {
            margin-bottom: 30px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }

        .test-header {
            background: #f5f5f5;
            padding: 15px 20px;
            font-weight: 600;
            font-size: 18px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .test-header:hover {
            background: #eeeeee;
        }

        .test-body {
            padding: 20px;
            background: white;
        }

        .test-item {
            padding: 12px 15px;
            margin: 8px 0;
            border-radius: 6px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: #f9f9f9;
        }

        .test-name {
            font-weight: 500;
            flex: 1;
        }

        .test-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 600;
            min-width: 100px;
            text-align: center;
        }

        .status-pending {
            background: #fff3cd;
            color: #856404;
        }

        .status-running {
            background: #cfe2ff;
            color: #084298;
            animation: pulse 1.5s infinite;
        }

        .status-pass {
            background: #d1e7dd;
            color: #0f5132;
        }

        .status-fail {
            background: #f8d7da;
            color: #842029;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; }
        }

        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #6c757d;
        }

        .btn-danger {
            background: #dc3545;
        }

        .btn-success {
            background: #28a745;
        }

        .actions {
            text-align: center;
            margin: 20px 0;
        }

        .log-output {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 20px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            max-height: 400px;
            overflow-y: auto;
            margin-top: 15px;
            line-height: 1.6;
        }

        .log-output .success { color: #4ec9b0; }
        .log-output .error { color: #f48771; }
        .log-output .warning { color: #dcdcaa; }
        .log-output .info { color: #9cdcfe; }

        .summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .summary-card {
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .summary-card .number {
            font-size: 36px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .summary-card .label {
            font-size: 14px;
            opacity: 0.8;
            font-weight: 500;
        }

        .summary-total { background: #e3f2fd; color: #1565c0; }
        .summary-pass { background: #e8f5e9; color: #2e7d32; }
        .summary-fail { background: #ffebee; color: #c62828; }
        .summary-warning { background: #fff8e1; color: #f57f17; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ” Admin Panel Diagnostics</h1>
            <p>×‘×“×™×§×ª ×ª×§×™× ×•×ª ×•×¤×•× ×§×¦×™×•× ×œ×™×•×ª ××œ××” ×©×œ ×¤×× ×œ ×”× ×™×”×•×œ</p>
        </div>

        <div class="content">
            <div class="actions">
                <button class="btn" onclick="runAllTests()">â–¶ï¸ ×”×¨×¥ ××ª ×›×œ ×”×‘×“×™×§×•×ª</button>
                <button class="btn btn-secondary" onclick="runFirebaseTests()">ğŸ”¥ ×‘×“×™×§×•×ª Firebase ×‘×œ×‘×“</button>
                <button class="btn btn-secondary" onclick="runAuthTests()">ğŸ” ×‘×“×™×§×•×ª Authentication ×‘×œ×‘×“</button>
                <button class="btn btn-danger" onclick="clearResults()">ğŸ—‘ï¸ × ×§×” ×ª×•×¦××•×ª</button>
            </div>

            <div class="summary" id="summary" style="display: none;">
                <div class="summary-card summary-total">
                    <div class="number" id="total-tests">0</div>
                    <div class="label">×‘×“×™×§×•×ª ×›×•×œ×œ×•×ª</div>
                </div>
                <div class="summary-card summary-pass">
                    <div class="number" id="passed-tests">0</div>
                    <div class="label">×¢×‘×¨ ×‘×”×¦×œ×—×” âœ“</div>
                </div>
                <div class="summary-card summary-fail">
                    <div class="number" id="failed-tests">0</div>
                    <div class="label">× ×›×©×œ âœ—</div>
                </div>
                <div class="summary-card summary-warning">
                    <div class="number" id="warning-tests">0</div>
                    <div class="label">××–×”×¨×•×ª âš </div>
                </div>
            </div>

            <!-- Firebase Tests -->
            <div class="test-section">
                <div class="test-header" onclick="toggleSection('firebase')">
                    <span>ğŸ”¥ ×‘×“×™×§×•×ª Firebase</span>
                    <span id="firebase-summary"></span>
                </div>
                <div class="test-body" id="firebase-section">
                    <div class="test-item">
                        <span class="test-name">Firebase SDK × ×˜×¢×Ÿ</span>
                        <span class="test-status status-pending" id="test-firebase-sdk">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">Firebase App ××•×ª×—×œ</span>
                        <span class="test-status status-pending" id="test-firebase-app">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">Firebase Auth ×–××™×Ÿ</span>
                        <span class="test-status status-pending" id="test-firebase-auth">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">Firestore ×–××™×Ÿ</span>
                        <span class="test-status status-pending" id="test-firestore">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">Firebase Functions ×–××™×Ÿ</span>
                        <span class="test-status status-pending" id="test-functions">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">×§×•× ×¤×™×’×•×¨×¦×™×” ×ª×§×™× ×”</span>
                        <span class="test-status status-pending" id="test-config">×××ª×™×Ÿ...</span>
                    </div>
                </div>
            </div>

            <!-- Authentication Tests -->
            <div class="test-section">
                <div class="test-header" onclick="toggleSection('auth')">
                    <span>ğŸ” ×‘×“×™×§×•×ª Authentication</span>
                    <span id="auth-summary"></span>
                </div>
                <div class="test-body" id="auth-section">
                    <div class="test-item">
                        <span class="test-name">Auth System ×§×™×™×</span>
                        <span class="test-status status-pending" id="test-auth-system">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">××¦×‘ ×”×ª×—×‘×¨×•×ª × ×•×›×—×™</span>
                        <span class="test-status status-pending" id="test-auth-state">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">×¤×¨×˜×™ ××©×ª××© × ×•×›×—×™</span>
                        <span class="test-status status-pending" id="test-current-user">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">×”×¨×©××•×ª Admin</span>
                        <span class="test-status status-pending" id="test-admin-perms">×××ª×™×Ÿ...</span>
                    </div>
                </div>
            </div>

            <!-- Data Manager Tests -->
            <div class="test-section">
                <div class="test-header" onclick="toggleSection('data')">
                    <span>ğŸ“Š ×‘×“×™×§×•×ª Data Manager</span>
                    <span id="data-summary"></span>
                </div>
                <div class="test-body" id="data-section">
                    <div class="test-item">
                        <span class="test-name">DataManager ×§×™×™×</span>
                        <span class="test-status status-pending" id="test-datamanager">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">×—×™×‘×•×¨ ×œ-Firestore</span>
                        <span class="test-status status-pending" id="test-db-connection">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">×˜×¢×™× ×ª ××©×ª××©×™×</span>
                        <span class="test-status status-pending" id="test-load-users">×××ª×™×Ÿ...</span>
                    </div>
                </div>
            </div>

            <!-- UI Components Tests -->
            <div class="test-section">
                <div class="test-header" onclick="toggleSection('ui')">
                    <span>ğŸ¨ ×‘×“×™×§×•×ª UI Components</span>
                    <span id="ui-summary"></span>
                </div>
                <div class="test-body" id="ui-section">
                    <div class="test-item">
                        <span class="test-name">DashboardUI ×§×™×™×</span>
                        <span class="test-status status-pending" id="test-dashboard-ui">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">××œ×× ×˜×™ DOM × ×˜×¢× ×•</span>
                        <span class="test-status status-pending" id="test-dom-elements">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">Modals System</span>
                        <span class="test-status status-pending" id="test-modals">×××ª×™×Ÿ...</span>
                    </div>
                    <div class="test-item">
                        <span class="test-name">Notifications System</span>
                        <span class="test-status status-pending" id="test-notifications">×××ª×™×Ÿ...</span>
                    </div>
                </div>
            </div>

            <!-- Console Output -->
            <div class="test-section">
                <div class="test-header">
                    <span>ğŸ“‹ Console Output</span>
                </div>
                <div class="test-body">
                    <div class="log-output" id="console-output">
                        <div class="info">ï¿½ï¿½ ×œ×•×’ ×”×‘×“×™×§×•×ª ×™×•×¤×™×¢ ×›××Ÿ...</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Test Results Storage
        const testResults = {
            total: 0,
            passed: 0,
            failed: 0,
            warnings: 0
        };

        // Console Output
        const consoleOutput = document.getElementById('console-output');

        function log(message, type = 'info') {
            const timestamp = new Date().toLocaleTimeString('he-IL');
            const className = type;
            const icon = {
                'success': 'âœ…',
                'error': 'âŒ',
                'warning': 'âš ï¸',
                'info': 'ğŸ“Œ'
            }[type] || 'ğŸ“Œ';

            const line = document.createElement('div');
            line.className = className;
            line.textContent = `[${timestamp}] ${icon} ${message}`;
            consoleOutput.appendChild(line);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;

            // Also log to browser console
            console.log(`[Diagnostics] ${message}`);
        }

        function setTestStatus(testId, status, message = '') {
            const element = document.getElementById(testId);
            if (!element) return;

            element.className = 'test-status status-' + status;

            const statusText = {
                'pending': '×××ª×™×Ÿ...',
                'running': '×‘×•×“×§...',
                'pass': 'âœ“ ×¢×‘×¨',
                'fail': 'âœ— × ×›×©×œ',
                'warning': 'âš  ××–×”×¨×”'
            }[status] || status;

            element.textContent = message || statusText;

            // Update counters
            if (status === 'pass') {
                testResults.passed++;
            } else if (status === 'fail') {
                testResults.failed++;
            } else if (status === 'warning') {
                testResults.warnings++;
            }

            updateSummary();
        }

        function updateSummary() {
            document.getElementById('summary').style.display = 'grid';
            document.getElementById('total-tests').textContent = testResults.total;
            document.getElementById('passed-tests').textContent = testResults.passed;
            document.getElementById('failed-tests').textContent = testResults.failed;
            document.getElementById('warning-tests').textContent = testResults.warnings;
        }

        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId + '-section');
            if (section.style.display === 'none') {
                section.style.display = 'block';
            } else {
                section.style.display = 'none';
            }
        }

        async function runFirebaseTests() {
            log('ğŸ”¥ ××ª×—×™×œ ×‘×“×™×§×•×ª Firebase...', 'info');
            testResults.total += 6;

            // Test 1: Firebase SDK
            setTestStatus('test-firebase-sdk', 'running');
            await sleep(300);
            if (typeof firebase !== 'undefined') {
                setTestStatus('test-firebase-sdk', 'pass');
                log('Firebase SDK × ×˜×¢×Ÿ ×‘×”×¦×œ×—×”', 'success');
            } else {
                setTestStatus('test-firebase-sdk', 'fail');
                log('Firebase SDK ×œ× × ××¦×!', 'error');
                return false;
            }

            // Test 2: Firebase App
            setTestStatus('test-firebase-app', 'running');
            await sleep(300);
            if (firebase.apps && firebase.apps.length > 0) {
                setTestStatus('test-firebase-app', 'pass', `âœ“ ${firebase.apps.length} apps`);
                log(`Firebase Apps: ${firebase.apps.map(a => a.name).join(', ')}`, 'success');
            } else {
                setTestStatus('test-firebase-app', 'fail');
                log('Firebase App ×œ× ××•×ª×—×œ!', 'error');
                return false;
            }

            // Test 3: Firebase Auth
            setTestStatus('test-firebase-auth', 'running');
            await sleep(300);
            if (window.firebaseAuth) {
                setTestStatus('test-firebase-auth', 'pass');
                log('Firebase Auth ×–××™×Ÿ', 'success');
            } else {
                setTestStatus('test-firebase-auth', 'fail');
                log('Firebase Auth ×œ× ×–××™×Ÿ!', 'error');
            }

            // Test 4: Firestore
            setTestStatus('test-firestore', 'running');
            await sleep(300);
            if (window.firebaseDB) {
                setTestStatus('test-firestore', 'pass');
                log('Firestore ×–××™×Ÿ', 'success');

                // Try to read a document
                try {
                    const testDoc = await window.firebaseDB.collection('employees').limit(1).get();
                    log(`Firestore: × ××¦××• ${testDoc.size} ××¡××›×™× ×‘×§×•×œ×§×¦×™×™×ª employees`, 'info');
                } catch (error) {
                    log(`×©×’×™××” ×‘×§×¨×™××ª Firestore: ${error.message}`, 'warning');
                }
            } else {
                setTestStatus('test-firestore', 'fail');
                log('Firestore ×œ× ×–××™×Ÿ!', 'error');
            }

            // Test 5: Functions
            setTestStatus('test-functions', 'running');
            await sleep(300);
            if (window.firebaseFunctions) {
                setTestStatus('test-functions', 'pass');
                log('Firebase Functions ×–××™×Ÿ', 'success');
            } else {
                setTestStatus('test-functions', 'warning');
                log('Firebase Functions ×œ× ×–××™×Ÿ', 'warning');
            }

            // Test 6: Config
            setTestStatus('test-config', 'running');
            await sleep(300);
            const app = firebase.apps[0];
            if (app && app.options) {
                const config = app.options;
                if (config.projectId && config.apiKey) {
                    setTestStatus('test-config', 'pass');
                    log(`Project ID: ${config.projectId}`, 'success');
                    log(`Auth Domain: ${config.authDomain}`, 'info');
                } else {
                    setTestStatus('test-config', 'fail');
                    log('×§×•× ×¤×™×’×•×¨×¦×™×” ×œ× ×ª×§×™× ×”!', 'error');
                }
            }

            log('ğŸ”¥ ×‘×“×™×§×•×ª Firebase ×”×•×©×œ××•', 'success');
            return true;
        }

        async function runAuthTests() {
            log('ğŸ” ××ª×—×™×œ ×‘×“×™×§×•×ª Authentication...', 'info');
            testResults.total += 4;

            // Test 1: AuthSystem exists
            setTestStatus('test-auth-system', 'running');
            await sleep(300);
            if (window.AuthSystem) {
                setTestStatus('test-auth-system', 'pass');
                log('AuthSystem × ×˜×¢×Ÿ ×‘×”×¦×œ×—×”', 'success');
            } else {
                setTestStatus('test-auth-system', 'fail');
                log('AuthSystem ×œ× × ××¦×!', 'error');
                return false;
            }

            // Test 2: Auth State
            setTestStatus('test-auth-state', 'running');
            await sleep(300);
            if (window.firebaseAuth) {
                const user = window.firebaseAuth.currentUser;
                if (user) {
                    setTestStatus('test-auth-state', 'pass', 'âœ“ ××—×•×‘×¨');
                    log(`××©×ª××© ××—×•×‘×¨: ${user.email}`, 'success');
                } else {
                    setTestStatus('test-auth-state', 'warning', 'âš  ×œ× ××—×•×‘×¨');
                    log('××™×Ÿ ××©×ª××© ××—×•×‘×¨', 'warning');
                }
            }

            // Test 3: Current User Details
            setTestStatus('test-current-user', 'running');
            await sleep(300);
            const currentUser = window.firebaseAuth?.currentUser;
            if (currentUser) {
                setTestStatus('test-current-user', 'pass');
                log(`Email: ${currentUser.email}`, 'info');
                log(`UID: ${currentUser.uid}`, 'info');
                log(`Display Name: ${currentUser.displayName || '×œ× ××•×’×“×¨'}`, 'info');

                // Get token
                try {
                    const token = await currentUser.getIdTokenResult();
                    log(`Custom Claims: ${JSON.stringify(token.claims)}`, 'info');
                } catch (error) {
                    log(`×©×’×™××” ×‘×§×‘×œ×ª token: ${error.message}`, 'warning');
                }
            } else {
                setTestStatus('test-current-user', 'warning', 'âš  ×œ× ××—×•×‘×¨');
                log('××™×Ÿ ××©×ª××© ××—×•×‘×¨ - ×“×œ×’ ×¢×œ ×‘×“×™×§×”', 'warning');
            }

            // Test 4: Admin Permissions
            setTestStatus('test-admin-perms', 'running');
            await sleep(300);
            if (window.AuthSystem && currentUser) {
                const isAdmin = window.AuthSystem.isCurrentUserAdmin();
                if (isAdmin) {
                    setTestStatus('test-admin-perms', 'pass', 'âœ“ Admin');
                    log('×”××©×ª××© ×”×•× Admin', 'success');
                } else {
                    setTestStatus('test-admin-perms', 'fail', 'âœ— ×œ× Admin');
                    log('×”××©×ª××© ××™× ×• Admin!', 'error');
                }
            } else {
                setTestStatus('test-admin-perms', 'warning', 'âš  ×œ× ××—×•×‘×¨');
                log('×œ× × ×™×ª×Ÿ ×œ×‘×“×•×§ ×”×¨×©××•×ª - ××™×Ÿ ××©×ª××© ××—×•×‘×¨', 'warning');
            }

            log('ğŸ” ×‘×“×™×§×•×ª Authentication ×”×•×©×œ××•', 'success');
            return true;
        }

        async function runDataTests() {
            log('ğŸ“Š ××ª×—×™×œ ×‘×“×™×§×•×ª Data Manager...', 'info');
            testResults.total += 3;

            // Test 1: DataManager exists
            setTestStatus('test-datamanager', 'running');
            await sleep(300);
            if (window.DataManager) {
                setTestStatus('test-datamanager', 'pass');
                log('DataManager × ×˜×¢×Ÿ ×‘×”×¦×œ×—×”', 'success');
            } else {
                setTestStatus('test-datamanager', 'fail');
                log('DataManager ×œ× × ××¦×!', 'error');
                return false;
            }

            // Test 2: DB Connection
            setTestStatus('test-db-connection', 'running');
            await sleep(300);
            if (window.DataManager.db) {
                setTestStatus('test-db-connection', 'pass');
                log('×—×™×‘×•×¨ ×œ-Firestore ×ª×§×™×Ÿ', 'success');
            } else {
                setTestStatus('test-db-connection', 'fail');
                log('××™×Ÿ ×—×™×‘×•×¨ ×œ-Firestore!', 'error');
                return false;
            }

            // Test 3: Load Users
            setTestStatus('test-load-users', 'running');
            await sleep(300);
            try {
                const users = await window.firebaseDB.collection('employees').get();
                setTestStatus('test-load-users', 'pass', `âœ“ ${users.size} ××©×ª××©×™×`);
                log(`× ××¦××• ${users.size} ××©×ª××©×™× ×‘××¢×¨×›×ª`, 'success');

                // Log first 3 users
                let count = 0;
                users.forEach(doc => {
                    if (count < 3) {
                        const data = doc.data();
                        log(`  - ${data.email || doc.id} (${data.role || '×œ× ××•×’×“×¨'})`, 'info');
                        count++;
                    }
                });
            } catch (error) {
                setTestStatus('test-load-users', 'fail');
                log(`×©×’×™××” ×‘×˜×¢×™× ×ª ××©×ª××©×™×: ${error.message}`, 'error');
            }

            log('ğŸ“Š ×‘×“×™×§×•×ª Data Manager ×”×•×©×œ××•', 'success');
            return true;
        }

        async function runUITests() {
            log('ğŸ¨ ××ª×—×™×œ ×‘×“×™×§×•×ª UI Components...', 'info');
            testResults.total += 4;

            // Test 1: DashboardUI
            setTestStatus('test-dashboard-ui', 'running');
            await sleep(300);
            if (window.DashboardUI) {
                setTestStatus('test-dashboard-ui', 'pass');
                log('DashboardUI × ×˜×¢×Ÿ ×‘×”×¦×œ×—×”', 'success');
            } else {
                setTestStatus('test-dashboard-ui', 'fail');
                log('DashboardUI ×œ× × ××¦×!', 'error');
            }

            // Test 2: DOM Elements
            setTestStatus('test-dom-elements', 'running');
            await sleep(300);
            const requiredElements = [
                'loginScreen',
                'dashboardScreen',
                'loginForm',
                'emailInput',
                'passwordInput'
            ];

            let missingElements = [];
            requiredElements.forEach(id => {
                if (!document.getElementById(id)) {
                    missingElements.push(id);
                }
            });

            if (missingElements.length === 0) {
                setTestStatus('test-dom-elements', 'pass', `âœ“ ${requiredElements.length} ××œ×× ×˜×™×`);
                log('×›×œ ××œ×× ×˜×™ ×”-DOM ×”× ×“×¨×©×™× ×§×™×™××™×', 'success');
            } else {
                setTestStatus('test-dom-elements', 'fail', `âœ— ×—×¡×¨×™× ${missingElements.length}`);
                log(`××œ×× ×˜×™× ×—×¡×¨×™×: ${missingElements.join(', ')}`, 'error');
            }

            // Test 3: Modals
            setTestStatus('test-modals', 'running');
            await sleep(300);
            if (window.Modals) {
                setTestStatus('test-modals', 'pass');
                log('Modals System ×–××™×Ÿ', 'success');
            } else {
                setTestStatus('test-modals', 'warning');
                log('Modals System ×œ× ×–××™×Ÿ', 'warning');
            }

            // Test 4: Notifications
            setTestStatus('test-notifications', 'running');
            await sleep(300);
            if (window.Notifications) {
                setTestStatus('test-notifications', 'pass');
                log('Notifications System ×–××™×Ÿ', 'success');
            } else {
                setTestStatus('test-notifications', 'warning');
                log('Notifications System ×œ× ×–××™×Ÿ', 'warning');
            }

            log('ğŸ¨ ×‘×“×™×§×•×ª UI Components ×”×•×©×œ××•', 'success');
            return true;
        }

        async function runAllTests() {
            clearResults();
            log('ğŸš€ ××ª×—×™×œ ×‘×“×™×§×” ××œ××” ×©×œ ×”××¢×¨×›×ª...', 'info');
            log('â•'.repeat(50), 'info');

            await runFirebaseTests();
            log('â•'.repeat(50), 'info');

            await runAuthTests();
            log('â•'.repeat(50), 'info');

            await runDataTests();
            log('â•'.repeat(50), 'info');

            await runUITests();
            log('â•'.repeat(50), 'info');

            // Final Summary
            log(`âœ… ×‘×“×™×§×•×ª ×©×¢×‘×¨×•: ${testResults.passed}`, 'success');
            log(`âŒ ×‘×“×™×§×•×ª ×©× ×›×©×œ×•: ${testResults.failed}`, testResults.failed > 0 ? 'error' : 'info');
            log(`âš ï¸  ××–×”×¨×•×ª: ${testResults.warnings}`, testResults.warnings > 0 ? 'warning' : 'info');
            log('â•'.repeat(50), 'info');

            if (testResults.failed === 0) {
                log('ğŸ‰ ×›×œ ×”×‘×“×™×§×•×ª ×¢×‘×¨×• ×‘×”×¦×œ×—×”!', 'success');
            } else {
                log('âš ï¸  ×™×© ×‘×¢×™×•×ª ×©×“×•×¨×©×•×ª ×ª×©×•××ª ×œ×‘', 'warning');
            }
        }

        function clearResults() {
            testResults.total = 0;
            testResults.passed = 0;
            testResults.failed = 0;
            testResults.warnings = 0;

            consoleOutput.innerHTML = '<div class="info">ğŸ“ ×œ×•×’ ×”×‘×“×™×§×•×ª ×™×•×¤×™×¢ ×›××Ÿ...</div>';

            // Reset all test statuses
            document.querySelectorAll('.test-status').forEach(el => {
                el.className = 'test-status status-pending';
                el.textContent = '×××ª×™×Ÿ...';
            });

            updateSummary();
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        // Auto-collapse sections on load
        window.addEventListener('DOMContentLoaded', () => {
            log('ğŸ“‹ Diagnostics Tool ××•×›×Ÿ ×œ×©×™××•×©', 'info');
            log('×œ×—×¥ ×¢×œ "×”×¨×¥ ××ª ×›×œ ×”×‘×“×™×§×•×ª" ×›×“×™ ×œ×”×ª×—×™×œ', 'info');
        });
    </script>
</body>
</html>