<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>×‘×“×™×§×ª ×ª×§×Ÿ ×©×¢×•×ª</title>
</head>
<body>
<h1>×‘×“×™×§×ª ×ª×§×Ÿ ×©×¢×•×ª - haim@ghlawoffice.co.il</h1>
<div id="status"></div>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>

<script>
// Firebase Configuration
const firebaseConfig = {
  apiKey: "AIzaSyBN8PsuM2wCm0eeUmWZ7TfiHTw0zXN2OQo",
  authDomain: "law-office-system-e4801.firebaseapp.com",
  projectId: "law-office-system-e4801",
  storageBucket: "law-office-system-e4801.firebasestorage.app",
  messagingSenderId: "574608275476",
  appId: "1:574608275476:web:c869ad4c5b8f20fe8c6607"
};

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

async function checkDailyTarget() {
    const statusDiv = document.getElementById('status');

    try {
        statusDiv.innerHTML = '<p>â³ ×©×•×œ×£ × ×ª×•× ×™× ×-Firestore...</p>';

        const userEmail = 'haim@ghlawoffice.co.il';
        const doc = await db.collection('employees').doc(userEmail).get();

        if (!doc.exists) {
            statusDiv.innerHTML = '<p style="color: red;">âŒ ××©×ª××© ×œ× × ××¦×!</p>';
            return;
        }

        const data = doc.data();

        statusDiv.innerHTML = `
            <h2>âœ… × ×ª×•× ×™ ×”×¢×•×‘×“:</h2>
            <table border="1" cellpadding="10" style="border-collapse: collapse;">
                <tr>
                    <th>×©×“×”</th>
                    <th>×¢×¨×š</th>
                </tr>
                <tr>
                    <td>××™××™×™×œ</td>
                    <td>${data.email}</td>
                </tr>
                <tr>
                    <td>×©×</td>
                    <td>${data.displayName}</td>
                </tr>
                <tr style="background-color: ${data.dailyHoursTarget ? '#d4edda' : '#f8d7da'};">
                    <td><strong>×ª×§×Ÿ ×©×¢×•×ª ×™×•××™</strong></td>
                    <td><strong>${data.dailyHoursTarget !== undefined ? data.dailyHoursTarget : '×œ× ××•×’×“×¨'}</strong></td>
                </tr>
                <tr>
                    <td>×¢×“×›×•×Ÿ ××—×¨×•×Ÿ</td>
                    <td>${data.updatedAt ? new Date(data.updatedAt.seconds * 1000).toLocaleString('he-IL') : '×œ× ×–××™×Ÿ'}</td>
                </tr>
            </table>

            <h2>ğŸ“Š ×—×™×©×•×‘ ×ª×§×Ÿ ×—×•×“×©×™:</h2>
            <p>×ª×§×Ÿ ×™×•××™: <strong>${data.dailyHoursTarget || 8.45}</strong> ×©×¢×•×ª/×™×•×</p>
            <p>×™××™ ×¢×‘×•×“×” ×‘×“×¦××‘×¨ 2025: <strong>23</strong> ×™××™×</p>
            <p>×ª×§×Ÿ ×—×•×“×©×™: <strong>${(data.dailyHoursTarget || 8.45) * 23}</strong> ×©×¢×•×ª</p>

            ${data.dailyHoursTarget ?
                `<p style="color: green; font-weight: bold;">âœ… ×ª×§×Ÿ ××™×©×™ ×”×•×’×“×¨ ×‘×”×¦×œ×—×”!</p>` :
                `<p style="color: orange; font-weight: bold;">âš ï¸ ×ª×§×Ÿ ××™×©×™ ×œ× ×”×•×’×“×¨ - ×™×©×ª××© ×‘×‘×¨×™×¨×ª ××—×“×œ (8.45)</p>`
            }
        `;

    } catch (error) {
        statusDiv.innerHTML += `<p style="color: red;">âŒ ×©×’×™××”: ${error.message}</p>`;
        console.error('Full error:', error);
    }
}

// ×”×¨×¥ ××ª ×”×‘×“×™×§×”
checkDailyTarget();
</script>
</body>
</html>
