# 📋 Feature Planning Template - תבנית תכנון Feature

> **מטרה:** לחשוב על כל השרשרת לפני כתיבת קוד!
>
> **חובה:** מלא את כל הסעקציות לפני שמתחילים לכתוב קוד.

---

## 📌 1. פרטי Feature

### שם ה-Feature:
<!-- דוגמה: "תזכורת אוטומטית למשימות באיחור" -->

### תיאור קצר (1-2 משפטים):
<!-- מה ה-feature עושה? -->

### למה צריך את זה?
<!-- איזו בעיה זה פותר? מה הערך העסקי? -->

### עדיפות:
<!-- ☐ דחוף | ☐ גבוה | ☐ בינוני | ☐ נמוך -->

---

## 👤 2. מבט משתמש (User Story)

```
בתור: [סוג משתמש]
אני רוצה: [מה המשתמש רוצה לעשות]
כדי ש: [מה התוצאה הרצויה]
```

**דוגמה:**
```
בתור: עורך דין
אני רוצה: לקבל התראה כש-80% מהתקציב של משימה נוצל
כדי ש: אוכל להחליט אם להמשיך או לעצור לפני שהתקציב אוזל
```

---

## 🎬 3. תרחיש שימוש (Use Case)

### תרחיש ראשי:
<!-- תאר צעד אחרי צעד מה המשתמש עושה -->

1. משתמש...
2. המערכת...
3. משתמש...
4. המערכת...

### תרחישי קצה (Edge Cases):
<!-- מה קורה במצבים לא רגילים? -->

- מה אם המשתמש...?
- מה קורה כש...?
- איך מטפלים ב...?

---

## 🗺️ 4. מפת זרימת מידע (Flow Map)

<!-- תאר את השרשרת המלאה - כל שלב במערכת -->

| # | שלב | מה קורה? | קובץ אחראי | אירוע EventBus | מאזינים |
|---|-----|----------|------------|---------------|---------|
| 1 | משתמש לוחץ כפתור | פותח modal | `budget-tasks.js` | - | - |
| 2 | משתמש ממלא טופס | validation | `forms.js` | - | - |
| 3 | לוחץ שמור | שליחה ל-Firebase | `budget-tasks.js` | `task:creating` | - |
| 4 | Firebase מצליח | עדכון cache | `firebase-service.ts` | `task:created` | `statistics.js`, `ui-updater.js` |
| 5 | עדכון UI | רענון רשימה | `budget-tasks.js` | `ui:refresh` | Dashboard |

**💡 טיפ:** השתמש ב-`EventAnalyzer.visualizeFlow()` כדי לבדוק אירועים קיימים!

---

## 🎯 5. אירועים (Events)

### אירועים חדשים שצריך ליצור:

| אירוע | Payload | מי שולח | מי מאזין | מוגדר ב-EventBus? |
|-------|---------|---------|----------|-------------------|
| `budget:threshold-reached` | `{ taskId, threshold: 80, current, estimate }` | `budget-tasks.js` | `notifications.js` | ☐ צריך להוסיף |
| - | - | - | - | - |

### אירועים קיימים שנשתמש בהם:

| אירוע | מטרה |
|-------|------|
| `task:created` | עדכון סטטיסטיקות |
| - | - |

---

## 📦 6. רכיבים נדרשים (Components)

### קבצים קיימים שצריך לערוך:

| קובץ | מה צריך להוסיף | אומדן שורות |
|------|----------------|-------------|
| `js/modules/budget-tasks.js` | לוגיקת בדיקת threshold | ~50 |
| `js/modules/notification-system.js` | תבנית התראה חדשה | ~20 |
| - | - | - |

### קבצים חדשים שצריך ליצור:

| קובץ | מטרה | תיקייה |
|------|------|---------|
| `budget-monitor.js` | ניטור תקציבים | `js/modules/` |
| - | - | - |

**⚠️ חשוב:** לפני יצירת קובץ חדש - חפש אם כבר יש קובץ רלוונטי!
```bash
# Glob חיפוש
**/*budget*.js
**/*monitor*.js
```

---

## 🗄️ 7. מבנה נתונים (Data Structure)

### שינויים ב-Firestore:

| אוסף | שדות חדשים | טיפוס | ברירת מחדל |
|------|------------|-------|------------|
| `budget_tasks` | `notificationsSent` | `string[]` | `[]` |
| `budget_tasks` | `thresholds` | `{ 50: bool, 80: bool, 100: bool }` | `{}` |
| - | - | - | - |

### שינויים ב-localStorage/cache:

| מפתח | נתונים | מטרה |
|------|--------|------|
| `budget-alerts-shown` | `{ taskId: [50, 80] }` | מניעת התראות כפולות |
| - | - | - |

---

## 🎨 8. ממשק משתמש (UI)

### רכיבי UI חדשים:

| רכיב | מיקום | סגנון |
|------|-------|-------|
| כפתור "התראות תקציב" | ליד כל משימה | badge אדום אם יש התראה |
| modal הגדרות | Settings → Notifications | form עם toggles |
| - | - | - |

### שינויים ב-CSS:

| קובץ CSS | מה להוסיף |
|----------|-----------|
| `css/notifications.css` | `.budget-alert { ... }` |
| - | - |

---

## ✅ 9. בדיקות (Testing)

### תרחישי בדיקה:

- [ ] משימה מגיעה ל-50% - התראה מופיעה
- [ ] משימה מגיעה ל-80% - התראה שונה מופיעה
- [ ] משימה חורגת (>100%) - התראה אדומה
- [ ] משתמש משבית התראות - לא מופיע כלום
- [ ] רענון דף - התראות לא מופיעות שוב (cache)
- [ ] Edge case: משימה ללא תקציב - לא קורס

### נתוני בדיקה (Test Data):

```javascript
// משימה לבדיקה
{
  taskId: 'TEST-001',
  estimate: 100,
  spent: 50,  // 50% - צריך התראה
  employee: 'test@example.com'
}
```

---

## 🚧 10. תלויות ומגבלות

### תלויות טכניות:

- ☐ צריך EventBus v2.0
- ☐ צריך notification-system.js
- ☐ צריך Firestore rules update?

### מגבלות ידועות:

- התראות רק בדפדפן (לא push notifications)
- לא עובד אם המשתמש offline
- -

---

## 📅 11. לוח זמנים

| שלב | זמן משוער | סטטוס |
|-----|-----------|-------|
| תכנון ואישור | 30 דק' | ☐ |
| EventBus - הגדרת אירועים | 15 דק' | ☐ |
| לוגיקת ניטור תקציבים | 2 שעות | ☐ |
| ממשק משתמש | 1 שעה | ☐ |
| בדיקות | 1 שעה | ☐ |
| תיקון באגים | 30 דק' | ☐ |
| **סה"כ** | **~5 שעות** | ☐ |

---

## 🔍 12. סקירה עצמית (Self-Review)

לפני שמתחילים לכתוב קוד - ענה על השאלות:

### ☑️ האם חשבתי על...

- [ ] מה קורה אם המשתמש offline?
- [ ] מה קורה אם Firebase מחזיר שגיאה?
- [ ] איך זה ישפיע על performance?
- [ ] האם צריך אישור מנהל?
- [ ] האם יש קוד דומה כבר במערכת?
- [ ] האם התיעוד ברור?

### ☑️ האם הזרימה הגיונית?

- [ ] כל אירוע יש לו listener
- [ ] אין אירועים יתומים (orphans)
- [ ] ההשרשרת ברורה ולינארית

### ☑️ האם זה ניתן לתחזוקה?

- [ ] הקוד ממוקם במקום הנכון
- [ ] שמות משתנים ברורים
- [ ] יש הערות בעברית
- [ ] אין קוד כפול (DRY)

---

## 🎉 13. אישור סופי

**חתימה:** _________________
**תאריך:** ___/___/_____

---

## 💡 טיפים לשימוש בתבנית

### לפני שמתחילים:
1. **העתק את התבנית** → צור `FEATURE_[שם].md`
2. **מלא בסבלנות** → אל תדלג על סעקציות!
3. **שתף עם AI** → קלוד יכול לעזור למלא

### בזמן העבודה:
- **עדכן בזמן אמת** → המסמך משתנה? עדכן את התבנית
- **סמן ✅** → משהו הושלם? סמן ב-checkbox

### אחרי הסיום:
- **שמור ב-docs/** → יש היסטוריה מלאה
- **קישור מ-README** → אחרים ילמדו ממך

---

**זכור:** 5 דקות תכנון חוסכות שעה של רפקטור! 💪
